<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">    
<head>
    <link rel="stylesheet" th:href="@{/admin.css}">
    
</head>
<body>
    <script th:src="@{/admin.js}"></script>
    <aside class="sidebar">
        <h2>üõ†Ô∏è Panel Admin</h2>

        <div class="admin-section" style="max-width: 450px; margin: auto; background: #222; padding: 20px; border-radius: 8px; color: white;">
            <h3 id="titulo-form-cat" style="margin-top: 0; font-size: 1.2rem; color: #aaa;">Crear Nueva Categor√≠a</h3>
            
            <div style="margin-bottom: 15px;">
                <label style="font-size: 0.85rem; color: #888;">Nombre de la Categor√≠a:</label>
                <input type="text" id="new-category-name" placeholder="Ej: Bebidas" 
                    style="width: 100%; padding: 10px; margin-top: 5px; background: #333; border: 1px solid #444; color: white; border-radius: 4px;">
            </div>

            <div style="margin-bottom: 20px;">
                <label style="font-size: 0.85rem; color: #888;">Categor√≠a Padre / Editar Existente:</label>
                <select id="cat-parent" onchange="actualizarBotones()" style="width: 100%; padding: 10px; margin-top: 5px; background: #333; border: 1px solid #444; color: white; border-radius: 4px;">
                    <option value="">Cargando...</option>
                </select>
            </div>

            <div style="display: flex; gap: 10px;">
                <button id="btn-guardar-cat" onclick="guardarCategoria()" 
                        style="flex: 1; padding: 10px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">
                    Guardar
                </button>
                
                <button id="btn-preparar-edicion" onclick="prepararEdicionDesdeSelect()" 
                        style="flex: 1; padding: 10px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; display: none;">
                    Editar Seleccionada
                </button>

                <button id="btn-eliminar-cat" onclick="eliminarCategoriaSeleccionada()" 
                        style="flex: 1; padding: 10px; background: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; display: none;">
                    Borrar
                </button>


                <button id="btn-cancelar-cat" onclick="cancelarEdicionCat()" 
                        style="padding: 10px; background: #444; color: white; border: none; border-radius: 4px; cursor: pointer; display: none;">
                    X
                </button>
            </div>
        </div>

        <div class="section-box">
            <h3>üë§ Crear Nuevo Usuario</h3>
            <label>Usuario (Nombre de ingreso):</label>
            <input type="text" id="new-username" placeholder="Ej: juan.perez" required>

            <label>Contrase√±a:</label>
            <input type="password" id="new-password" placeholder="Clave123" required>

            <label>Tipo de Usuario:</label>
            <select id="new-role">
                <option value="CLIENTE">Cliente</option>
                <option value="ADMIN">Administrador</option>
            </select>

            <button onclick="crearUsuarioDesdeAdmin()" class="btn-add" style="margin-top: 10px;">
                ‚ûï Crear Usuario
            </button>
        </div>

    </aside>

    <main class="main-content">
        <div class="tab-menu" style="margin-bottom: 20px;">
            <button onclick="mostrarSeccion('productos')" class="btn-tab">üì¶ Gestionar Productos</button>
            <button onclick="mostrarSeccion('usuarios')" class="btn-tab">üë§ Gestionar Usuarios</button>
        </div>

        <div id="seccion-productos">
            <h3>üì¶ Inventario Actual</h3>
                
            <div id="contenedor-filtros" style="margin-bottom: 20px;">
                <div class="categoria-selector">
                    <p style="color: white; margin-bottom: 10px;">
                        Categor√≠a seleccionada: <strong id="nombre-seleccionada" style="color: #4CAF50;">Ninguna</strong>
                    </p>
                    <input type="hidden" id="categoriaIdInput" name="categoryId">
                    
                    <div id="niveles-categorias"></div>
                    
                    <button class="filter-btn" onclick="limpiarFiltros()" style="margin-top: 10px; background: #666;">
                        Limpiar Filtros
                    </button>
                </div>
            </div>

            <input type="text" id="busquedaAdmin" placeholder="Filtrar por nombre o ID..." 
                onkeyup="ejecutarFiltroFinal()" 
                style="padding: 10px; width: 100%; margin-bottom: 20px;">

            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Imagen</th>
                        <th>Nombre</th>
                        <th>Precio</th>
                        <th>Stock</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="tabla-productos">
                    </tbody>
            </table>
        </div>

        <div id="seccion-usuarios" style="display:none;">
            <h3>üë• Lista de Usuarios Registrados</h3>
            <table style="width:100%; color: white; background: #222; border-collapse: collapse;">
                <thead>
                    <tr style="background: #333;">
                        <th>ID</th>
                        <th>Usuario</th>
                        <th>Contrase√±a</th> <th>Rol</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="tabla-usuarios-body"></tbody>
            </table>
        </div>
    </main>
    <div class="btn-colapsar" onclick="toggleSidebar()" title="Mostrar/Ocultar Panel">
        ‚ò∞
    </div>
</body>
</html>