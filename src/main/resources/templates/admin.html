<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">    
<head>
    <link rel="stylesheet" th:href="@{/admin.css}">
    
</head>
<body>
    <script th:src="@{/admin.js}"></script>
    <aside class="sidebar">
        <h2>üõ†Ô∏è Panel Admin</h2>

        <div class="admin-section">
            <h3>Gesti√≥n de Categor√≠as</h3>
            <label>Nombre:</label>
            <input type="text" id="new-category-name" placeholder="Ej: Parlantes" required>

            <label>Categor√≠a / Padre:</label>
            <select id="cat-parent">
                <option value="">Ninguna (Es Categor√≠a Principal)</option>
            </select>
            
            <div style="display: flex; gap: 10px; margin-top: 10px;">
                <button onclick="guardarNuevaCategoria()" class="btn-add" style="flex: 1;">Guardar</button>
                <button onclick="prepararEdicionCategoria()" class="btn-edit" style="flex: 1; margin-bottom: 0;">Editar</button>
            </div>
            
            <button id="btn-cancelar-cat" onclick="cancelarEdicionCat()" style="display:none; background:#6c757d; color:white; margin-top: 10px;">
                Cancelar Edici√≥n
            </button>
        </div>

        <div class="section-box">
            <h3>üë§ Crear Nuevo Usuario</h3>
            <label>Usuario (Nombre de ingreso):</label>
            <input type="text" id="new-username" placeholder="Ej: juan.perez" required>

            <label>Contrase√±a:</label>
            <input type="password" id="new-password" placeholder="Clave123" required>

            <label>Tipo de Usuario:</label>
            <select id="new-role">
                <option value="CLIENTE">Cliente</option>
                <option value="ADMIN">Administrador</option>
            </select>

            <button onclick="crearUsuarioDesdeAdmin()" class="btn-add" style="margin-top: 10px;">
                ‚ûï Crear Usuario
            </button>
        </div>

    </aside>

    <main class="main-content">
        <div class="tab-menu" style="margin-bottom: 20px;">
            <button onclick="mostrarSeccion('productos')" class="btn-tab">üì¶ Gestionar Productos</button>
            <button onclick="mostrarSeccion('usuarios')" class="btn-tab">üë§ Gestionar Usuarios</button>
        </div>

        <div id="seccion-productos">
            <h3>üì¶ Inventario Actual</h3>
                
            <div id="contenedor-filtros" style="margin-bottom: 20px;">
                <div id="categorias-padres" style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="btn-categoria active" onclick="seleccionarPadre(this, 'TODOS')">Todos</button>

                    <button th:each="cat : ${categoriasPadre}" 
                            class="btn-categoria" 
                            th:text="${cat.name}" 
                            th:onclick="|seleccionarPadre(this, ${cat.id})|">
                    </button>
                </div>

                <div id="categorias-hijas" style="display: flex; gap: 8px; margin-top: 10px; margin-left: 20px;"></div>
            </div>

            <input type="text" id="busquedaAdmin" placeholder="Filtrar por nombre o ID..." 
                onkeyup="ejecutarFiltroFinal()" 
                style="padding: 10px; width: 100%; margin-bottom: 20px;">

            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Imagen</th>
                        <th>Nombre</th>
                        <th>Precio</th>
                        <th>Stock</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="tabla-productos">
                    </tbody>
            </table>
        </div>

        <div id="seccion-usuarios" style="display:none;">
            <h3>üë• Lista de Usuarios Registrados</h3>
            <table style="width:100%; color: white; background: #222; border-collapse: collapse;">
                <thead>
                    <tr style="background: #333;">
                        <th>ID</th>
                        <th>Usuario</th>
                        <th>Contrase√±a</th> <th>Rol</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="tabla-usuarios-body"></tbody>
            </table>
        </div>
    </main>
    <div class="btn-colapsar" onclick="toggleSidebar()" title="Mostrar/Ocultar Panel">
        ‚ò∞
    </div>
</body>
</html>